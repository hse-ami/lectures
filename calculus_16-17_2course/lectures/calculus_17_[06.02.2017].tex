\section{Лекция 17 от 06.02.2017 \\ Замкнутые и полные ортогональные системы. Тригонометрическая система}
\subsection{Замкнутые и полные ортогональные системы}
Пусть $H$ --- пространство со скалярным произведением, $\{e_n\}_{n=1}^{\infty}$  --- счетная ортогональная система в $H$. Тогда для вектора $x \in H$ можно ввести \textit{коэффициенты Фурье}: $\x_n = \dfrac{(x, e_n)}{(e_n, e_n)}$ и, соответственно, \textit{ряд Фурье}: $\sseries \x_ne_n $. Отметим, что этот ряд не является ни числовым, ни функциональным.

Продолжим обсуждение замкнутых ортогональных систем. Повторим определение (на этот раз сформулируем его немного иначе).
\begin{Def}
Ортогональная система $\{e_n\}_{n=1}^{\infty}$ называется \textit{замкнутой}, если
$$
\forall x \in H \ \forall \eps > 0 \ \exists N \in \N \ \exists c_1, \ldots, c_n \colon \left|\left|x - \series{1}{N}c_ne_n\right|\right| < \eps.
$$
\end{Def}

\begin{Theorem}
    \label{16equiv}
Следующие утверждения эквивалентны:
\begin{enumerate}
\item ортогональная система $\{e_n\}_{n=1}^{\infty}$ замкнута;
\item $\forall x \in H \  \sseries\x_ne_n = x$;
\item $\forall x \in H \ \sseries \x^2_n||e_n||^2 = ||x||^2 $;
\item $\forall x, y \in H \ (x, y) = \sseries \x_n\y_n||e_n||^2$.
\end{enumerate}
\end{Theorem}
\begin{proof}
Фактически это просто суммирование предыдущих результатов. Действительно, $(1) \Rightarrow (2)$ и $(2) \Leftrightarrow (3)$ было доказано на прошлой лекции, $(2) \Rightarrow (1)$ следует очевидным образом.  Из нового: $(4) \Rightarrow (3)$ получается сразу при $y = x$, и только $(3) \Rightarrow (4)$ требует какого-то доказательства.

Заметим, что $\widehat{(x + y)}_n = \x_n + \y_n$. Тогда:
\begin{gather*}
(x, y) = \frac{(x + y, x+y) - (x, x) - (y, y)}{2} = \frac{1}{2} \left( \sseries (\x_n + \y_n)^2 ||e_n||^2 - \sseries \x_n^2||e_n||^2 - \sseries \y^2||e_n||^2 \right) = \\ = \sseries \x_n\y_n||e_n||^2.
\end{gather*}
Собственно, утверждение $(4)$ тоже иногда называют \textit{равенством Парсеваля}.
\end{proof}

\begin{Def}
Ортогональная система $\{e_n\}_{n=1}^{\infty}$ называется \textit{полной}, если из того, что $\forall n \in \N \ (x, e_n) = 0$ следует, что $x = 0$, то есть существует только один вектор, ортогональный всей системе.
\end{Def}

Понятия \textit{замкнутости} и \textit{полноты} в разной литературе используются абы как и часто меняются местами. Это связано с тем, что данные термины \textit{почти} взаимозаменяемы.

\begin{Statement}
Если ортогональная система замкнута, то она полна.
\end{Statement}
\begin{proof}
Если $\{e_n\}_{n=1}^{\infty}$ --- замкнутая ортогональная система, то $\forall x \in H\ x = \sseries\x_ne_n$. Но если $\forall n \in N\ (x, e_n) = 0$, то $\x_n = 0$ и, следовательно, $x = \sseries 0 = 0$. 
\end{proof}

\begin{Statement}
Если ортогональная система $\{e_n\}_{n=1}^{\infty}$ полна \textit{в полном пространстве $H$}, то она замкнута.
\end{Statement}
\begin{proof}
Пусть $x$ --- произвольный элемент из $H$. Рассмотрим соответствующий ряд Фурье, который в силу полноты пространства обязан куда-то сходиться: $y := \sseries \x_ne_n$. Из теоремы о единственности разложения следует, что $\forall n \in \N\ \x_n = \y_n$, а значит, $(x, e_n) = (y, e_n)$. Итого, $\forall n \in \N \ (x - y, e_n) = 0$, что верно только если $x - y = 0$, то есть $x = y$. Таким образом $\forall x \in H   x = \sseries \x_ne_n$ и осталось применить теорему \ref{16equiv}.
\end{proof}
\begin{Task}[Бонусная задача]
Наше доказательство не пройдет в любом пространстве, но это не означает, что полнота пространства является необходимым требованием. Итак, верно ли, что во всех (не обязательно полных) пространствах если ортогональная система полна, то она замкнута?
\end{Task}

\subsection{Пара слов о практическом применении}
Допустим, мы имеем дело с черно-белым изображением (с цветным все аналогично). Фактически это функция, заданная на пространстве-прямоугольнике $P$, где $f(p)$ --- интенсивность пикселя. Можно ввести скалярное произведение: $(f, g) = \int\limits_P fg \,\d x\d y$. Однако так как мы работаем с дискретным пиксельным пространством, интеграл можно заменить на сумму: $\sum\limits_{i, j = 1}^{\dots}a_{ij}b_{ij}$, где $a$ и $b$ --- это значения пикселей.

Выберем конечную ортогональную систему $\{e_n\}_{n=1}^N$. Для удобства пусть она будет нормированной, то есть $||e_n|| = 1$. Тогда $x = \sum\limits_{n = 1}^{N} \x_ne_n$. Известно, что 
$$\left|\left|x - \series{1}{K}\x_ne_n\right|\right|^2 = ||x||^2 - \series{1}{K}\x_n^2.$$

На практике (для счастья) мы хотим брать не все коэффициенты Фурье, а только несколько из них. А глядя на равенство выше понятно, что лучше взять большие по модулю коэффициенты, чтобы уменьшить погрешность. Именно эта идея и лежит в основе алгоритмов сжатия с частичной потерей данных (но это не вся идея).

Соответственно, встает вопрос: а как выбрать ортогональную систему так, чтобы как можно меньше коэффициентов Фурье были большими и как можно больше --- маленькими? Тогда для такой системы элементы можно будет с небольшой погрешностью "<сильно сжать"> при хранении.

\subsection{Тригонометрическая система}
В математическом анализе есть два самых главных отрезка: $[0, 1]$ и $[-\pi, \pi]$. Будем работать со вторым.

Пусть $(f, g) = \int\limits_{-\pi}^{\pi} f(x)g(x) \d x$. Функции не обязательно должны быть непрерывными, потому что на практике разрывы I рода встречаются сплошь и рядом (например, граница фона и объекта на изображении). Поэтому будем рассматривать функции $f, g \in R[-\pi, \pi]$.

Факторизуем пространство по следующему отношению эквивалентности: $f \sim g \Leftrightarrow \\ \int\limits_{\pi}^{\pi}(f - g)^2 \d x = 0$. 

Строго говоря, можно было бы рассматривать функции, интегрируемые по Риману в несобственном смысле, но тогда и интеграл $\int\limits_{-\pi}^{\pi}fg \d x$ был бы несобственным, и чтобы он существовал, необходимо потребовать интегрируемость в несобственном смысле квадратов функций, так как $(f, g) \leq \dfrac{f^2 + g^2}{2}$, что помогло бы нам ограничить интеграл. Но полученное пространство все еще не будем полным, поэтому мы не будем его рассматривать --- это всего лишь полушаг к желаемому результату и оно того не стоит.

Итак, тригонометрическая система в таком пространстве: $1, \cos x, \sin x, \cos 2x, \sin 2x, \ldots$.

Посчитаем квадрат длины каждого вектора:
\begin{align*}
&(1, 1) =  \int\limits_{-\pi}^{\pi} 1 \cdot 1 \d x = 2\pi;\\
&(\sin nx, \sin nx) =  \int\limits_{-\pi}^{\pi} \sin^2 nx \d x =  \int\limits_{-\pi}^{\pi} \frac{1 - \cos 2nx}{2} \d x =  \int\limits_{-\pi}^{\pi} \dfrac{1}{2} = \pi;\\
&(\cos nx, \cos nx) = \ldots = \pi.
\end{align*}

По традиции (а, к слову, тригонометрическая система старше интегралов Римана), коэффициенты Фурье, связанные с $\cos nx$ и $\sin nx$ принято обозначать как $a_n $ и $b_n$ соответственно:
\begin{align*}
&a_n = \frac{1}{\pi}  \int\limits_{-\pi}^{\pi} f(x) \cos nx \d x;\\
&b_n = \frac1\pi  \int\limits_{-\pi}^{\pi} f(x) \sin nx \d x.
\end{align*}
А коэффициент Фурье при 1 очень похож на коэффициенты при $\cos nx$, поэтому его принято обозначать как $a_0/2$:
$$
\frac{a_0}{2} = \frac{1}{2\pi} \int\limits_{-\pi}^{\pi} f(x) \cdot 1 \d x.
$$

Итого, ряд Фурье для функции $f$ выглядит следующим образом:
$$
\frac{a_0}{2} + \sseries a_n \cos nx + b_n \sin nx.
$$
Для аккуратности надо бы ставить скобки под суммой, но это и так воспринимается как единое целое.

Для тригонометрической системы есть дальше два вектора развития:
\begin{enumerate}
\item Доказать замкнутость (или полноту). Вот только пространство неполное, так что лучше замкнутость.
\item Заметить, что ряд Фурье в данном случае это обычный функциональный ряд, и для него осмысленен вопрос, чему равно $f(1)$ и так далее.
\end{enumerate}

\subsection{Комплексная форма тригонометрической системы}
Если внимательно посмотреть на ряд Фурье тригонометрической системы, то можно заметить, что он степенной --- точнее, к нему можно свести, используя комплексную запись все той же тригонометрической системы: $\{ e^{inx} \}_{-\infty}^{+\infty}$.

В комплексном случае $(x, y) = \overline{(y, x)}$, поэтому $(f, g) =  \int\limits_{-\pi}^{\pi} f(x)\overline{g(x)} \d x$. Тогда
\begin{gather*}
(e^{inx}, e^{inx}) =  \int\limits_{-\pi}^{\pi} e^{inx} \overline{e^{inx}} \d x=  \int\limits_{-\pi}^{\pi} e^{inx} e^{-inx} \d x =  \int\limits_{-\pi}^{\pi} 1 \d x = 2 \pi.
\end{gather*}

По традиции, коэффициенты Фурье обозначают как $c_n$:
$$
c_n = \frac{1}{2\pi}  \int\limits_{-\pi}^{\pi} f(x) e^{-inx} \d x.
$$

Итого, комплексный ряд Фурье выглядит следующим образом:
$$
\series{-\infty}{\infty} c_n e^{inx}  = \lim\limits_{N \to \infty} \series{-N}{N} c_n e^{inx}.
$$

Покажем, что это то же самое, что и ряд Фурье по обычной тригонометрической системе.
\begin{align*}
& c_n = \frac{1}{2\pi}  \int\limits_{-\pi}^{\pi} f(x) (\cos nx - i\sin nx) \d x = \frac{a_n}{2} - i \frac{b_n}{2};\\
& c_{-n} = \ldots = \frac{a_n}{2} + i \frac{b_n}{2}.
\end{align*}
Итого:
\begin{gather*}
c_n e^{inx} + c_{-n} e^{-inx} = \left( \frac{a_n}{2} - i\frac{b_n}{2} \right)(\cos nx + i\sin nx) + \left( \frac{a_n}{2} + i\frac{b_n}{2} \right)(\cos nx - i\sin nx) =\\= a_n \cos nx + b_n \sin nx.
\end{gather*}

Двумерные пространства, натянутые на $\langle \cos nx , \sin nx \rangle$ и $\langle e^{inx}, e^{-inx} \rangle$, будут совпадать, в них равны наилучшие приближения и частичные суммы.

