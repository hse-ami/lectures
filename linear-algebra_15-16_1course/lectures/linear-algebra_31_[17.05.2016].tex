\section{Лекция 31 от 17.05.2016}

\subsection*{Самосопряжённые линейные операторы (продолжение)}

Пусть $\mathbb{E}$ --- евклидово пространство, $\dim \mathbb{E} = n$, $\varphi \in L(\mathbb{E})$. Вспомним, что по определению сопряжённый линейный оператор $\phi^*$ это такой линейный оператор, для которого выполняется следующее:
$$
(x,\;\varphi(y)) = (\varphi^*(x),\; y).
$$

Вспомним также, что самосопряженным называется такой оператор $\phi$, для которого $\phi^* = \phi$.

\begin{Suggestion}
	Пусть $\varphi$ --- самосопряженный линейный оператор в $\E$. Если $U \subseteq \mathbb{E}$ ---\\ $\phi$-инвариантное подпространство в $\E$, то $U^\perp$ тоже $\varphi$-инвариантно.
\end{Suggestion}

Поясним, что означает этот факт.
	 
Пусть $\dim U = m$ и $U = \langle e_1, \ldots, e_m \rangle$. Так как $\E = U \oplus U^\perp$, то $\dim U^\perp = n - m$ и \\$U^\perp = \langle e_{m+1}, \ldots, e_n\rangle$, где $\e = (e_1, \ldots, e_n)$ --- базис $\E$.
	 
Тогда матрица $\phi$ в базисе $\e$ имеет следующий блочный вид: 
$$
\begin{pmatrix}A & B \\ C & D\end{pmatrix}, \quad  A \in M_m,\ D \in M_{n-m}.
$$	 
Когда $U$ --- $\phi$-инвариантно, то есть $\phi(U) \subseteq U$, эта матрица принимает вид $\begin{pmatrix}A & B \\ 0 & D\end{pmatrix}$, так как базисные векторы $e_1,\ldots e_m$ переходят в себя, не затрагивая векторы $e_{m+1}, \ldots, e_n$. И мы хотим доказать, что $U^\perp$ тоже является $\phi$-инвариантным подпространством, то есть блок $B$ также равен нулю, то есть матрица $\phi$ в базисе $\e$ имеет вид $\begin{pmatrix}A & 0 \\ 0 & D\end{pmatrix}$.

\begin{proof}	 
	Известно, что $\phi = \phi^*$ и $\phi(U) \subseteq U$.
	Мы хотим, чтобы $\varphi(U^\perp) \subseteq U^\perp$. Для этого нам достаточно показать, что $(x, \phi(y)) = 0$ для любых векторов $x \in U$ и $y \in U^\perp$. 
	\[
		(x,\varphi(y)) = (\varphi^*(x), y) = (\underbrace{\varphi(x)}_{\in U}, \underbrace{y}_{\in U^\perp}) = 0
	\]
\end{proof}

\begin{Suggestion}
	У самосопряжённого оператора $\varphi$ есть собственный вектор над $\mathbb{R}$. 
\end{Suggestion}

\begin{proof}
	Ранее в курсе мы уже доказывали, что у $\phi$ существует одномерное или двумерное $\phi$-инвариантное подпространство. Рассмотрим соответствующие случаи.
	
\begin{enumerate}
	\item Если существует одномерное $\phi$-инвариантное подпространство, то его порождающий вектор является собственным.
	
	\item Пусть $U \subseteq \mathbb{E}$ --- двумерное $\phi$-инвариантное подпространство и $\mathbb{e} = (e_1, e_2)$ --- его ортонормированный базис. Пусть $\psi \in L(U)$ --- ограничение $\varphi$ на $U$. В прошлый раз мы уже доказывали, что матрица $\psi$ имеет симметрический вид, то есть $A(\psi, \mathbb{e}) = \begin{pmatrix}
		a& b\\
		b& c
	\end{pmatrix}$.
	Рассмотрим его характеристический многочлен:
	\begin{gather*}
	\chi_\psi(t) = (-1)^2\begin{vmatrix}
	a-t& b\\
	b& c-t
	\end{vmatrix} = t^2 - (a + c)t + ac - b^2 = 0;\\
	D = (a - c)^2 + 4b^2 \geqslant 0.
	\end{gather*}
	Так как дискриминант неотрицательный, то у $\chi_\psi(t)$ есть хотя бы один корень. Следовательно, у $\psi$ есть собственный вектор $v$. Но $\psi$ --- ограничение $\phi$, так что вектор $v$ тоже является для него собственным.
\end{enumerate}

\end{proof}

\begin{Theorem}
	У всякого самосопряжённого линейного оператора есть ортонормированный базис из собственных векторов. В частности, $\varphi$ диагонализуем над $\mathbb{R}$ и его характеристический многочлен разлагается в произведение линейных сомножителей.
\end{Theorem}

\begin{Consequence}
	Всякая симметричная матрица над $\mathbb{R}$ подобна диагональной.
\end{Consequence}

\begin{proof}
	Докажем индукцией по $n$.
	
	Для $n = 1$ всё очевидно. Если $n > 1$, то у $\varphi$ есть собственный вектор $v$. Положим $e_1 = \cfrac{v}{|v|}$ и $U = \langle e_1\rangle^\perp$. Тогда $\dim U = n - 1$, причем $U$ --- $\varphi$-инвариантное подпространство (см. предыдущее предложение). По предположеню индукции в $U$ есть ортонормированный базис из собственных векторов $(e_2,\ldots, e_n)$. Тогда $(e_1,\ldots, e_n)$ --- искомый базис.
\end{proof}

\begin{Consequence}
	Пусть $\varphi$ --- самосопряженный линейный оператор, и $\lambda, \mu$ --- его собственные значения. Тогда $V_\lambda(\varphi)\perp V_\mu(\varphi)$ при $\lambda \neq \mu$.
\end{Consequence}

\begin{proof}\ 
	\begin{enumerate} 
		\item \underline{Координатный способ.} Пусть $\mathbb{e} = (e_1, \ldots, e_n)$ --- ортонормированный базис из собственных векторов, где $\varphi(e_i) = \lambda_ie_i$. Тогда для произвольного вектора $x = x_1e_1 + \ldots + x_ne_n$ из $V$ верно, что $\varphi(x) = x_1\lambda_1 e_1 + \ldots + x_n \lambda_n e_n$.
		
		Несложно понять, что если $x \in V_\l(\phi)$, то есть $\phi(x) = \l x$, то тогда $x$ принадлежит линейной оболочке тех базисных векторов, чье собственное значение равно $\l$: $x \in \langle e_i \mid \l_i = \l \rangle$. А так как базисные векторы попарно ортогональны в силу свойств выбранного базиса, то как раз получаем, что $V_\l(\phi) \perp V_\mu(\phi)$, если $\l \neq \mu$.
		\item \underline{Бескоординатный способ.} Возьмем произвольные векторы $x \in V_\l(\phi)$ и $y \in V_\mu(\phi)$. Тогда:
		$$
			\lambda(x,y) = (\lambda x, y) = (\varphi(x), y) = (x, \varphi(y)) = (x, \mu y) = \mu (x, y).
		$$
		А поскольку $\lambda \neq \mu$, то $(x,y) = 0$.
	\end{enumerate}
\end{proof}

\begin{Consequence}[Приведение квадратичной формы к главным осям]
	Для любой квадратичной формы $Q$ над $\mathbb{E}$ существует ортонормированный базис, в котором $Q$ имеет канонический вид. 
	$$
	Q(x_1, \ldots, x_n) = \lambda_1 x_1^2 + \ldots + \lambda_n x_n^2.
	$$
	Причем числа $\lambda_1, \ldots, \lambda_n$ определены однозначно с точностью до перестановки.
\end{Consequence}

Это более сильное утверждение, чем мы доказывали ранее, так как теперь мы говорим именно про ортонормированный базис.

\begin{proof}
	Существует единственный самосопряжённый линейный оператор $\phi$ в $\mathbb{E}$ такой, что $Q(v) = (v, \varphi(v))$. Если $\mathbb{e}$ --- ортонормированный базис, то матрица $Q$ в базисе $\mathbb{e}$ будет равна матрице $\varphi$ в базисе $\mathbb{e}$. Числа $\lambda_1, \ldots, \lambda_n$ являются собственными значениями $\varphi$. 
\end{proof}

\begin{Consequence}
	Пусть $A\in M_n(\mathbb{R}), A = A^T$. Тогда существует ортогональная матрица $C$ такая, что 
	$$
	C^TAC = C^{-1} AC = D = \mathrm{diag}(\lambda_1, \ldots, \lambda_n).
	$$
\end{Consequence}

\subsection{Ортогональные линейные операторы}

\begin{Def}
	Линейный оператор $\varphi \in L(\mathbb{E})$ называется ортогональным, если
	$$
	(\varphi(x), \varphi(y)) = (x,y), \quad \forall x, y \in \E.
	$$
	Другими словами, $\varphi$ сохраняет скалярное произведение, осуществляет изоморфизм $\E$ на себя.
\end{Def}

\begin{Suggestion}
Пусть $\phi$ --- линейный оператор в $\E$. Тогда следующие условия эквивалентны:
\begin{enumerate}
\item $\phi$ --- ортогональный линейный оператор;
\item $|\phi(x)| = |x|$ для всех $x \in \E$, то есть $\phi$ сохраняет длины;
\item существует $\phi^{-1}$, причем $\phi^{-1} = \phi^*$, то есть $\phi \cdot \phi^* = \phi^*\cdot \phi = \id$;
\item если $\e$ --- ортонормированный базис, то $A(\phi, \e)$ --- ортогональная матрица;
\item если $(e_1, \ldots, e_n)$ --- ортонормированный базис, то $(\phi(e_1), \ldots, \phi(e_n))$ --- тоже ортонормированный базис.
\end{enumerate}
\end{Suggestion}

\begin{proof}
Везде здесь $x, y \in \E$.
\begin{itemize}[align=left]
\item[$(1) \Rightarrow (2)$]
$$
|\phi(x)| = \sqrt{(\phi(x), \phi(x))} = \sqrt{(x, x)} = |x|
$$
\item[$(2) \Rightarrow (1)$] Используем поляризацию (см. лекция 26).
$$
(\phi(x), \phi(y) = \frac{1}{2}(|\phi(x + y)|^2 - |\phi(x)|^2 - |\phi(y)|^2) = \frac{1}{2}(|x + y|^2 - |x|^2 - |y|^2) = (x, y)
$$ 
\item[$(1)\&(2) \Rightarrow (3)$] Найдем ядро $\phi$:
\begin{gather*}
\phi(x) = 0 \quad \Rightarrow \quad |\phi(x)| = 0 \quad \Rightarrow \quad |x| = 0 \quad \Rightarrow \quad x = 0
\end{gather*}
Итого, $\Ker \phi = \{0\}$. Значит, существует $\phi^{-1}$. Теперь докажем, что $\phi^{-1} = \phi^*$:
\begin{gather*}
(\phi^{-1}(x), y) = (\phi(\phi^{-1}(x)), \phi(y)) = (x, \phi(y))
\end{gather*}
Получили, что $\phi^{-1}$ является сопряженным к $\phi$ по определению.
\item[$(3) \Rightarrow (1)$] 
$$
(\phi(x), \phi(y)) = (\phi^*(\phi(x)), y) = (x, y)
$$
\item[$(4) \Leftrightarrow (5)$] Пусть $\e = (e_1, \ldots, e_n)$ --- ортонормированный базис. Тогда верно, что
$$
(\phi(e_1), \ldots, \phi(e_n)) = (e_1, \ldots, e_n) \cdot C, \quad C = A(\phi, \e)
$$
Матрица $C$ является ортогональной тогда и только тогда, когда $(\phi(e_1), \ldots, \phi(e_n))$ --- ортонормированный базис.
\item[$(3) \Leftrightarrow (4)$] Пусть $\e$ --- ортонормированный базис, $C = A(\phi, \e)$. Тогда $A(\phi^*, \e) = C^T$ и условие, что $\phi\cdot\phi^* = id$ равносильно тому, что $C\cdot C^T = E$, то есть $C$ --- ортогональная матрица.
\end{itemize}
\end{proof}

\begin{Examples}
Тут надо придумать, как записывать.
\end{Examples}

\begin{Suggestion}
	Пусть $\varphi$ --- ортогональный линейный оператор в $\E$. Если $U \subseteq \mathbb{E}$ ---\\ $\phi$-инвариантное подпространство в $\E$, то $U^\perp$ тоже $\varphi$-инвариантно.
\end{Suggestion}

\begin{proof}
Рассмотрим $\psi$ --- ограничение $\phi$ на $U$. Оно, очевидно, тоже сохраняет длины, то есть также является ортогональным оператором. Следовательно, существует $\psi^{-1}$.

Достаточно показать, что $(x, \phi(y)) = 0$ для любых векторов $x \in U$ и $y \in U^\perp$.
\begin{gather*}
(x, \phi(y)) = (\psi(\psi^{-1}(x)), \phi(y)) = (\phi(\psi^{-1}(x)), \phi(y)) = (\underbrace{\psi^{-1}(x)}_{\in U}, \underbrace{y}_{\in U^\perp}) = 0
\end{gather*}
\end{proof}

Пусть $\Pi(\alpha) = \begin{pmatrix}
\cos\alpha & \sin\alpha \\
\sin\alpha & \cos\alpha
\end{pmatrix}$.

\begin{Theorem}
Пусть $\phi$ --- ортогональный линейный оператор в $\E$. Тогда существует ортонормированный базис $\e$ такой, что матрица $A(\phi, \e)$ имеет следующий блочно-диагональный вид:
$$
A(\phi, \e) :=
\begin{pmatrix}
\Pi(\alpha)\\
&\ddots \\
&&\Pi(\alpha)\\
&&&-1\\
&&&&\ddots\\
&&&&&-1\\
&&&&&& 1\\
&&&&&&& \ddots \\
&&&&&&&& 1
\end{pmatrix}.
$$
\end{Theorem}

