\section{Лекция от 30.09.2016}

\subsection{Сходимость случайных величин. Закон больших чисел.} 
Сначала введём пару определений:

\begin{definition}
    Пусть \(\{\xi_n\}_{n = 1}^{\infty}\)~--- последовательность случайных величин, заданных на вероятностном пространстве \((\Omega, \Pr)\). Тогда будем говорить, что последовательность \emph{сходится по вероятности} к случайной величине \(\xi\), если для любого положительного \(\alpha\) выполнено, что
    \[\lim\limits_{n \to \infty} \Pr{\left|\xi_n - \xi\right| \geq \alpha} = \lim\limits_{n \to \infty} \Pr{\{\omega : \left|\xi_n(\omega) - \xi(\omega)\right| \geq \alpha\}} = 0.\]
    
    Обозначение: \(\xi_n \prto \xi\).
\end{definition}

\begin{definition}
    Случайные величины \(\xi\) и \(\eta\) называют \emph{одинаково распределёнными}, если 
    \[
    \begin{cases}
    \xi(\Omega) = \eta(\Omega); \\
    \forall x \in \xi(\Omega), \Pr{\xi = x} = \Pr{\eta = x}.
    \end{cases}
    \]
    
    Говоря простым языком, у этих случайных величин совпадают возможные значения и их вероятности.
    
    \textbf{Обозначение:} $\xi \eqdist \eta$.
\end{definition}

\begin{theorem}[Закон больших чисел]
    Пусть есть последовательность попарно независимых и одинаково распределённых случайных величин \(\{\xi_n\}_{n = 1}^{\infty}\) и существует число \(C\) такое, что \(\D{\xi_n} \leq C\) для всех \(n \in \N\).
    
    Введём обозначение \(S_n = \xi_1 + \xi_2 + \dots + \xi_n\). Тогда
    \[\frac{S_n - \E{S_n}}{n} \prto 0.\]    
\end{theorem}
\begin{proof}
    Для начала заметим, что \(\E{\frac{S_n - \E{S_n}}{n}} = 0\). Тогда по неравенству Чебышёва выполнено, что:
    \[\Pr{\left|\frac{S_n - \E{S_n}}{n}\right| \geq \epsilon} \leq \frac{\D{\frac{S_n - \E{S_n}}{n}}}{\epsilon^2}.\] 
    
    Так как \(\D{\frac{S_n - \E{S_n}}{n}} = \frac{1}{n^2}\D{S_n}\) для фиксированного \(n\), то 
    \[\Pr{\left|\frac{S_n - \E{S_n}}{n}\right| \geq \epsilon} \leq \frac{\D{S_n}}{n^2\epsilon^2}.\]
    
    Распишем дисперсию в виде суммы ковариаций:
    \[\D{S_n} = \cov(\xi_1 + \ldots + \xi_n, \xi_1 + \ldots + \xi_n) = \sum\limits_{i, j = 1}^{n} \cov(\xi_i, \xi_j).\]
    
    Если \(i \neq j\), то случайные величины \(\xi_i\) и \(\xi_j\) независимы. Но тогда они некоррелированы и \(\cov(\xi_i, \xi_j) = 0\). Следовательно,
    \[\D{S_n} = \sum\limits_{i = 1}^{n} \cov(\xi_i, \xi_i) \leq Cn.\]
    
    Подставляя выражение дисперсии, получаем, что
    \[\Pr{\left|\frac{S_n - \E{S_n}}{n}\right| \geq \epsilon} \leq \frac{C}{n\epsilon^2}\xrightarrow[n \to \infty]{} 0.\qedhere\]
    
	%В силу того, что \(\cov(\xi_i, \xi_j) = 0 \  \forall i \neq j,  \text{ то } \D[S_n] = \D[\xi_1 + \ldots + \xi_n] = \cov(\xi_1 + \ldots + \xi_n, \xi_1 + \ldots + \xi_n) = \sum\limits_{i=1}^{n}\cov(\xi_i, \xi_i) = \sum\limits_{i=1}^{n}\D[\xi_i] \leq n \cdot c.\)
	
	%\noindentДалее по свойству дисперсии \(\D[\frac{S_n - \E[S_n]}{n}] = \frac{1}{n^2}\D[S_n].\) А исходя из рассуждения выше, данную величину можно оценить сверху: \(\frac{1}{n^2}\D[S_n] \leq \frac{c}{n}.\)
	
	%\noindentНаконец, для любых положительных $ \alpha $ по неравенству Чебышёва \(\Pr(\left|\frac{S_n - \E[s_n]}{n}\right| \geq \alpha) \leq \frac{\D[\frac{S_n - \E[S_n]}{n}]}{\alpha^2}.\) Осталось только ограничить числитель уже имеющейся оценкой. \(\frac{\D[\frac{S_n - \E[S_n]}{n}]}{\alpha^2} \leq \frac{c}{n\alpha^2}.\) Несложно увидеть, что данная величина стремится к нулю при \(n \to \infty.\)
\end{proof}

\begin{remark}
    Вообще, в законе больших чисел не обязательна независимость случайных величин~--- достаточно попарной некоррелированности.
\end{remark}

\begin{consequence}
    Пусть \(\{\xi_n\}_{n = 1}^{\infty}\)~--- последовательность попарно независимых случайных величин. Пусть существуют \(\alpha\) и \(C\) такие, что \(\E{\xi_n} = \alpha\) и  \(\D{\xi_n} \leq C\) для всех \(n \in \N\). Тогда \[\frac{\xi_1 + \ldots + \xi_n}{n} \prto \alpha.\]
\end{consequence}
\begin{proof}
	Из условия независимости случайных величин нам хватит следствия о том, что они являются попарно некоррелированными. Из закона больших чисел следует, что \(\frac{S_n - \E[S_n]}{n} \prto 0\). Так как \(\E[S_n] = n\alpha\), то
	\(\frac{S_n}{n} - \alpha \prto 0\).
	Также заметим, что в силу определения сходимости, \(\frac{S_n}{n} \prto \alpha\).
\end{proof}
%Не понимаю пока, что происходит с матожиданием...
%Update: осознал.

Давайте попробуем осознать, в чем заключается смысл Закона больших чисел.
Пусть случайная величина задается индикатором происхождения события,  \(\xi_i = I \)\{событие $ A $ произошло в $ i $-ом эксперименте\}, при этом все эксперименты проводятся независимо друг от друга ($ \xi_n $ является независимой случайной величиной). Обозначим за \(\vartheta(A)\) частоту появления события $ A $ в $ n $-м количестве экспериментов, \(\vartheta_n(A) = \frac{\xi_1 + \ldots + \xi_n}{n}.\)
Тогда по Закону больших чисел \(\vartheta_n(A) \prto \E[\xi_i] = \E[I\text{\{событие $ A $ произошло в $ i $-ом эксперименте\}}] = \Pr(A).\) Выходит, что Закон больших чисел является теоретическим обоснованием принципа устойчивости частот. 

\begin{definition}
	Последовательность случайных величин \(\{\xi_n\}_{n = 1}^{\infty}\) сходится к случайной величине \(\xi\) c вероятностью 1 (или \emph{почти наверное}\footnote{Название ``сходимость почти наверное'' произошло от применяющегося в англоязычной литературе термина ``almost sure convergence''.}), если \[\Pr{\lim\limits_{n \to \infty}\xi_n = \xi} = \Pr{\left\{\omega : \lim\limits_{n \to \infty}\xi_n(\omega) = \xi(\omega)\right\}} = 1.\]
    
    Обозначение: \(\xi_n \asto \xi\) (сходится \emph{почти наверное}).
\end{definition}
\begin{remark}
    Данное определение можно записать следующим образом: для любого \(\omega \in \Omega\) такого, что \(\Pr{\omega} > 0\), выполнено \(\xi_n(\omega) \to \xi(\omega)\).
\end{remark}

\begin{theorem}
	В диcкретных вероятностных пространствах \(\xi_n \prto \xi \iff \xi_n \asto \xi\).
\end{theorem}

\begin{proof}
	Докажем по очереди в обе стороны:
	\begin{itemize}
        \item[{[\(\Rightarrow\)]}] Допустим, что \(\xi_n \prto \xi\). Докажем, что тогда для любого \(\omega \in \Omega\), для которого \(\Pr{\omega} > 0\), выполнено \(\xi_n(\omega) \to \xi(\omega)\) (стремится в понимании предела последовательности).
        
        Пусть есть элементарный исход \(\omega_0\) такой, что сходимости нет: \(\xi_n(\omega_0) \nrightarrow \xi(\omega_0)\). В таком случае существует положительное \(\alpha\) и подпоследовательность \(\{\xi_{n_k}(\omega_0)\}_{k = 1}^{\infty}\) такие, что \(\forall k \in \N \left|\xi_{n_k}(\omega_0) - \xi(\omega_0)\right| \geq \alpha\). Но тогда \(\Pr{\left|\xi_{n_k} - \xi\right| \geq \alpha}  \geq \Pr(\omega_0) > 0\). Но по определению сходимости по вероятности \(\Pr{\left|\xi_{n_k} - \xi\right| \geq \alpha} \to 0\). Получаем противоречие. Следовательно, \(\xi_n \asto \xi\).
        
        \item[{[\(\Leftarrow\)]}] Пусть \(\xi_n \asto \xi\). Согласно определению, \(\Pr(\lim\limits_{n \to \infty}\xi_n = \xi) = 1\). Это равносильно тому, что для любого \(\omega \in \Omega\), для которого \(\Pr{\omega} > 0\), выполнено \(\xi_n(\omega) \to \xi(\omega)\).
        
        Докажем, что выполнено условие сходимости \emph{по вероятности}: \(\Pr{\left|\xi_n - \xi \right| \geq \alpha} \to 0\) для любого положительного \(\alpha\). Пусть \(\Omega = \{\omega_i \mid i \in \N\}\). Зафиксируем произвольное \(\delta > 0\) и выберем номер \(N = N(\delta)\) такой, что \(\sum\limits_{i > N} \Pr(\omega_i) \leq \delta\). Тогда
        \[\begin{aligned}
        \Pr{\left|\xi_n - \xi\right| \geq \alpha} &= \sum_{i\,:\,\left|\xi_n(\omega_i) - \xi(\omega_i)\right| \geq \alpha} \Pr{\omega_i} \\
        &= \sum_{\substack{i\,:\,i \leq N \\ \left|\xi_n(\omega_i) - \xi(\omega_i)\right| \geq \alpha}} \Pr{\omega_i} + \sum_{\substack{i\,:\,i > N \\ \left|\xi_n(\omega_i) - \xi(\omega_i)\right| \geq \alpha}} \Pr{\omega_i} \\
        &\leq \sum_{\substack{i\,:\,i \leq N \\ \left|\xi_n(\omega_i) - \xi(\omega_i)\right| \geq \alpha}} \Pr{\omega_i} + \sum_{i > N} \Pr{\omega_i} \\
        &\leq \sum_{\substack{i\,:\,i \leq N \\ \left|\xi_n(\omega_i) - \xi(\omega_i)\right| \geq \alpha}} \Pr{\omega_i} + \delta.
        \end{aligned}\]
        
        Теперь нужно перейти к пределу при \(n \to \infty.\) Но чтобы избежать ситуации, когда предела не существует, перейдем к верхнему пределу для тех же \(n\). Также заметим, что так как \(\xi_n(\omega_i) \to \xi(\omega_i)\), начиная c некоторого \(n\), \(\omega_i\) перестает входить в сумму. Тогда первая сумма стремится к нулю и
        \[
        \overline{\lim_{n \to \infty}} \Pr{\left|\xi_n - \xi\right| \geq \alpha} \leq 0 + \delta.
        \]
        
        В силу произвольности \(\delta > 0\) можно говорить о том, что этот предел стремится к нулю. \(\qedhere\)
	\end{itemize}
\end{proof}

Допустим, что \(S_n \sim \mathrm{Bin}(n, p)\). Тогда сформулируем два вопроса:

\textbf{Вопрос 1:} Как оценить скорость сходимости \(\frac{S_n}{n} - a\) к нулю?

\textbf{Вопрос 2:} Как оценить скорость сходимости \(\Pr{\left|\frac{S_n}{n} - a\right| \geq \epsilon}\) к нулю?

\subsection{Схема испытаний Бернулли}
\textbf{Описание:} Схема испытаний Бернулли подразумевает много однородных экспериментов, в каждом из которых возможно два исхода --- ``успех'' и ``неудача''; при этом нас интересует распределение числа успехов.

\textbf{Математическая модель:} Пусть $\{\xi_i\}$ --- независимые \emph{одинаково распределённые} случайные величины (например, последовательные броски монеты); $\xi_i(\Omega) = \left\{ 0; 1 \right\}$; пусть также $\Pr(\xi_i = 1) = p$ --- вероятность успеха каждого отдельного эксперимента. Введём также обозначение $S_n = \sum\limits_{i = 1}^n \xi_i$ --- случайную величину, обозначающую количество успехов.

Распределение $S_n$ кажется очевидным: $S_n \sim \mathrm{Bin}(n, p)$, т.е. $\Pr(S_n = k) = C_n^kp^k(1-p)^{n-k}$.

\begin{exercise}
    Докажите, что распределение $S_n$ и вправду биномиально.
\end{exercise}

\begin{exercise}
    В качестве упражнения, читателю предлагается оценить, сколько нужно попыток, чтобы $\frac{\text{число успехов}}{\text{число попыток}}$ было примерно равно $p$, т.е. как быстро наблюдаемая вероятность сходится к реальной. Для этого предлагается оценить следующую вероятность:
\end{exercise}
\[
    \Pr\left(\left|\frac{S_n}{n}-p\right|\geq \epsilon\right) = ?
\]

Кстати говоря, $p$ совершенно не обязана быть константой и может являться функцией от $n$: $p(n)$.

Тогда, вообще говоря, есть несколько отдельных случаев:

\begin{itemize}
    \item
        $np(n) \xrightarrow[n\to\infty]{} \lambda > 0$.

        \begin{theorem}[Пуассон]

            Пусть $np(n) \xrightarrow[n\to\infty]{} \lambda > 0$.
            Тогда
                \[
                    \forall k \in \Z_+, \Pr(S_n = k) \xrightarrow[n\to\infty]{} e^{-\lambda}\frac{\lambda^k}{k!}.
                \]
        \end{theorem}
        \begin{proof}
            \begin{multline*}
                C_n^kp^k(1-p)^{n-k} =
                \frac{n(n-1)(n-2)\ldots(n-k+1)}{k!}p(n)^k(1-p(n))^{n-k} \sim\\\sim
                \frac{n^k}{k!}\left(\frac{\lambda}{n}+o\left(\frac{1}{n}\right)\right)^k\left( 1-\frac{\lambda}{n}+o\left( \frac{1}{n} \right) \right)^{n-k} =\\=
                \frac{1}{k!}\left(\lambda+o\left(1\right)\right)^k\left( 1-\frac{\lambda}{n}+o\left( \frac{1}{n} \right) \right)^{n-k} \xrightarrow[n\to\infty]{}
                \frac{\lambda^k}{k!}e^{-\lambda}
            \end{multline*}
        \end{proof}
        \textbf{Следствие:} $P(S_n = k) \overset{d}{\to} P(\xi = k),\ \xi \sim \mathrm{Pois}(\lambda)$ --- сходимость \emph{по распределению}.

    \item
        $np(n) \xrightarrow[n\to\infty]{} \infty$.

        Сделаем ещё одно отступлление в сторону и рассмотрим величину $\frac{S_n - \E[S_n]}{\sqrt{\D[S_n]}}$.
        Пусть \(\xi_1, \ldots, \xi_n \) --- $ n $ бернуллиевских случайных величин с \(\Pr{\xi_i = 1} = p,\ \Pr{\xi_i = 0} = q,\ p~+~q~=~1. \) Тогда для \(S_n = \xi_1 + \ldots + \xi_n \) 
        находим, что
        \[
            \E[S_n] = np.
        \]

        Несложно также показать, что
        \begin{multline*}
            \D[S_n] = \sum\D[\xi_i] + \sum\cov[x_i, x_j] = \sum\D[\xi_i] = n\D[\xi_1] =\\= n\left( \E[\xi_1^2]-\left( \E[\xi_1] \right)^2 \right) = n(p - p^2) = npq.
        \end{multline*}

        \begin{theorem}[Муавра-Лапласа]
           Пусть вероятность \(p\) того, что во время эксперимента произойдёт событие, постоянна и находится в интервале \((0, 1)\). Допустим, что было проведено \(n\) независимых испытаний. Обозначим за \(S_n\) количество испытаний, в которых произошло событие (это равносильно тому, что \(S_n \sim \mathrm{Bin}(n, p)\)). Введём следующее обозначение:
           \[\Pr_n(a,b)\mathop{:=} \Pr\left( a < \frac{S_n - \E[S_n]}{\sqrt{\D[S_n]}} \leq b \right).\]
           
           Тогда
           \[
           \sup_{a<b} \left|\Pr_n(a, b) - \int\limits_a^b\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}dx\right| \xrightarrow[n\to\infty]{} 0.
           \]
        \end{theorem}

\end{itemize}
