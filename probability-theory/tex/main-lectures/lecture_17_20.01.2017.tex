\section{Лекция от 20.01.2017}
\subsection{Дифференцирование характеристических функций}
Продолжим обсуждать характеристические функции. Вообще говоря, характеристическая функция~--- это вполне себе функция.\footnote{Да ладно?} Поэтому хотелось бы уметь, например, брать производные от характеристической функции. Но как они будут устроены? Ответ на это даёт следующая
\begin{theorem}[о производных характеристической функции]
	Пусть \(\xi\)~--- это некоторая случайная величина и \(\E{|\xi|^r} < +\infty\) для всех \(r \in \overline{1,\ldots,n}\). Тогда для всех \(r \in \{1, 2, \dots, n\}\) существуют \(\phi_{\xi}^{(r)}(t)\), причём
	\[
		\phi_{\xi}^{(r)}(t) = \E{(i\xi)^re^{it\xi}}.
	\]
	Более того,
	\begin{gather*}
		\phi_{\xi}^{(r)}(0) = i^r\E{\xi^r} \\
		\phi_{\xi}(t) = \sum_{k = 0}^{n} \frac{(it)^k}{k!}\E{\xi^k} + \frac{(it)^n}{n!}\mathcal{E}_n(t)
	\end{gather*}
	где \(\left|\mathcal{E}_n(t)\right| \leq 3\E{|\xi|^n}\) и \(\lim\limits_{t \to 0} \mathcal{E}_n(t) = 0\).
\end{theorem}
\begin{proof}
	Докажем первое утверждение только для первой производной, ибо утверждение для старших степеней легко обобщается по индукции аналогичный образом. Рассмотрим производную функции \(\phi_{\xi}(t)\) в точке \(t_0\):
	\[
		\phi_{\xi}'(t_0) = \lim\limits_{\Delta t \to 0} \frac{\phi_{\xi}(t_0 + \Delta t) - \phi_{\xi}(t_0)}{\Delta t} = \lim\limits_{\Delta t \to 0} \E{e^{i\xi t_0}\left(\frac{e^{i\xi \Delta t} - 1}{\Delta t}\right)}.
	\]
	
	Теперь заметим, что \(\frac{e^{i\xi \Delta t} - 1}{\Delta t} \asto i\xi\) (просто поточечная сходимость). Далее,
	\begin{align}
		|e^{i\xi \Delta t} - 1| &= |\cos(\xi \Delta t) + i\sin(\xi \Delta t) - 1| \\ &\leq |\cos(\xi \Delta t) - 1| + |\sin(\xi \Delta t)| \leq 2|\xi \Delta t|
	\end{align}
	Следовательно, по теореме Лебега можно считать и предел математического ожидания:
	\[
		\lim\limits_{\Delta t \to 0} \E{e^{i\xi t_0}\left(\frac{e^{i\xi \Delta t} - 1}{\Delta t}\right)} = \E{e^{i\xi t_0}(i\xi)}.
	\]
	Если подставить в полученную формулу 0, то получим, что
	\[
		\phi_{\xi}^{(r)}(0) = \E{(i\xi)^re^{0}} = \E{(i\xi)^r} = i^r\E{\xi^r}.
	\]
	
	Теперь докажем последнее утверждение. Разложим \(e^{iy}\) в ряд Тейлора-Маклорена с остаточным членом в форме Лагранжа до \((n - 1)\)-го порядка:
	\[
		e^{iy} = \cos(y) + i\sin(y) = \sum_{k = 0}^{n - 1} \frac{(iy)^k}{k!} + \frac{(iy)^n}{n!}(\cos(\theta_1 y) + i\sin(\theta_2 y)),
	\]
	где \(\theta_1, \theta_2 \in [0, 1]\).
	
	Почему мы берём именно до \((n - 1)\)-го порядка? Если взять до \(n\)-го порядка, то в остаточном члене будет \((n + 1)\)-я степень, а матожидание \(\E{\xi^{n + 1}}\) может быть бесконечным или вообще не существовать.
	
	Теперь возьмём матожидание от этого выражения в точке \(y = t\xi\):
	\[
		\E{e^{it\xi}} = \sum_{k = 0}^{n - 1} \frac{(it)^k}{k!}\E{\xi^k} + \frac{(it)^n}{n!}\E{\xi^{n}(\cos(\theta_1 t\xi) + i\sin(\theta_2 t\xi))}
	\]
	Теперь добавим и вычтем \(\frac{(it)^n}{k!}\E{\xi^{n}}\):
	\[
		\E{e^{it\xi}} = \sum_{k = 0}^{n} \frac{(it)^k}{k!}\E{\xi^k} + \frac{(it)^n}{n!}\E{\xi^{n}(\cos(\theta_1 t\xi) + i\sin(\theta_2 t\xi) - 1)}
	\]
	Осталось понять, что из себя представляет этот остаточный член. Введём обозначение
	\[
		\mathcal{E}_n(t) = \E{\xi^{n}(\cos(\theta_1 t\xi) + i\sin(\theta_2 t\xi) - 1)}.
	\]
	Теперь заметим, что
	\[
		|\mathcal{E}_n(t)| \leq \E{|\xi^{n}(\cos(\theta_1 t\xi) + i\sin(\theta_2 t\xi) - 1)|} \leq 3\E{|\xi|^{n}}
	\]
	Далее, при \(t \to 0\) выполнена поточечная сходимость:
	\[
		\cos(\theta_1 t\xi) + i\sin(\theta_2 t\xi) - 1 \asto 0
	\]
	И, конечно же, выражение внутри матожидания ограничено:
	\[
		|\xi^{n}(\cos(\theta_1 t\xi) + i\sin(\theta_2 t\xi) - 1)| \leq 3|\xi|^n
	\]
	Тогда, снова по теореме Лебега, можно перейти к пределу матожидания:
	\[
		\lim\limits_{t \to 0} \mathcal{E}_n(t) = 0.\qedhere
	\]
\end{proof}
\begin{remark}
	Заметим, что условие \(\lim\limits_{t \to 0} \mathcal{E}_n(t) = 0\) равносильно тому, что
	\[
		\E{\xi^{n}(\cos(\theta_1 t\xi) + i\sin(\theta_2 t\xi) - 1)} = o(1).
	\]
	Тогда формулу разложения можно записать иным образом:
	\[
		\phi_{\xi}(t) = \sum_{k = 0}^{n} \frac{(it)^k}{k!}\E{\xi^k} + o\left(\frac{t^n}{n!}\right)
	\]
\end{remark}
\begin{consequence}
	Если \(\E{\xi^2} \leq \infty\), то при \(t \to 0\) верна следующая формула
	\[
		\phi_{\xi}(t) = 1 + it\E{\xi} - \frac{t^2}{2}\E{\xi^2} + o(t^2)
	\]
\end{consequence}

\subsection{Харатеристическая функция случайного вектора и её свойства}
Ранее мы работали с характеристическими функциями случайных величин. Обобщим это понятие на случайные вектора:
\begin{definition}
	Пусть \(\xi \in \R^n\)~--- случайный вектор. Тогда \emph{характеристической функцией} случайного вектора \(\xi\) будем называть функцию
	\[
		\phi_{\xi}(\mathbf{t}) = \E{e^{i\left\langle\xi, \mathbf{t}\right\rangle}},\ \mathbf{t} \in \R^n
	\]
	В данном случае \(\left\langle\xi, \mathbf{t}\right\rangle = \sum_{k = 1}^{n} t_k\xi_k\)~--- скалярное произведение.
\end{definition}
Свойства данной характеристической функции остаются теми же, что и в одномерном случае. Например:
\begin{theorem}[единственности]
	Пусть \(\xi\) и \(\eta\)~--- некоторые случайные векторы в \(\R^n\). Тогда
	\[
		\forall\,\mathbf{t} \in \R^n\ \phi_{\xi}(\mathbf{t}) = \phi_{\eta}(\mathbf{t}) \iff \xi \eqdist \eta.
	\]
\end{theorem}
С характеристическими функциями случайных векторов связан ещё один факт. Как вы помните, если случайные величины \(\xi_{1}, \dots, \xi_{n}\) независимы в совокупности, то функция распределения случайного вектора \(\xi = (\xi_1, \dots, \xi_n)\) разбивалось в произведение функций распределения для случайных величин \(\xi_{1}, \dots, \xi_{n}\). Оказывается, что похожее утверждение верно и для характеристических функций.
\begin{theorem}[критерий независимости для характеристических функций]
	Случайные величины \(\xi_{1}, \dots, \xi_{n}\) независимы в совокупности тогда и только тогда, когда характеристическая функция вектора \(\xi = (\xi_{1}, \dots, \xi_{n})\) разбивается в произведение характеристических функций \(\xi_{i}\):
	\[
		\forall \mathbf{t} = (t_1, \dots, t_n) \in \R^n\ \phi_{\xi}(\mathbf{t}) = \prod_{k = 1}^{n} \phi_{\xi_i}(t_i).
	\]
\end{theorem}
\begin{proof}
	Как обычно, будем доказывать по очереди.
	\begin{itemize}
		\item[{\([\Rightarrow]\)}] Предположим, что случайные величины \(\xi_{1}, \dots, \xi_{n}\) независимы в совокупности. Тогда рассмотрим характеристическую функцию вектора \(\xi = (\xi_1, \dots, \xi_n)\):
		\[
			\phi_{\xi}(\mathbf{t}) = \E{e^{i\left\langle\xi, \mathbf{t}\right\rangle}} = \E{e^{i\sum_{k = 1}^{n} t_k\xi_k}} = \E{\prod_{k = 1}^{n} e^{it_k\xi_{k}}}
		\]
		Но, как известно, функции (борелевские) от незавимых случайных величин~--- это независимые случайные величины, а матожидание произведения независимых случайных величин разбивается в произведение матожиданий. Тогда
		\[
			\phi_{\xi}(\mathbf{t}) = \prod_{k = 1}^{n} \E{e^{it_k\xi_{k}}} = \prod_{k = 1}^{n} \phi_{\xi_i}(t_i).
		\]
		
		\item[{\([\Leftarrow]\)}] Теперь предположим, что
		\[
			\forall \mathbf{t} = (t_1, \dots, t_n) \in \R^n\ \phi_{\xi}(\mathbf{t}) = \prod_{k = 1}^{n} \phi_{\xi_i}(t_i).
		\]
		
		Покажем, что функция распределения \(F_{\xi}(\mathbf{t})\) аналогичным образом разбивается в произвдение. Для этого рассмотрим случайный вектор \(\eta = (\eta_1, \dots, \eta_n)\), где случайные величины \(\eta_1, \dots, \eta_n\) независимы в совокупности и \(\eta_{i} \eqdist \xi_{i}\) для \(i \in \{1, \dots, n\}\). Понятно, что его функция распределения равна
		\[
			F_{\eta}(\mathbf{t}) = \prod_{k = 1}^{n} F_{\eta_k}(t_k) = \prod_{k = 1}^{n} F_{\xi_k}(t_k)
		\]
		Осталось показать, что \(\phi_{\eta}(\mathbf{t}) = \phi_{\xi}(\mathbf{t})\). Действительно, согласно теореме единственности и первому пункту получаем, что
		\[
			\phi_{\eta}(\mathbf{t}) = \prod_{k = 1}^{n} \phi_{\eta_k}(t_k) = \prod_{k = 1}^{n} \phi_{\xi_k}(t_k) = \phi_{\xi}(\mathbf{t}).
		\]
		Следовательно, по теореме единственности
		\[
			\xi \eqdist \eta \implies F_{\xi}(\mathbf{t}) = F_{\eta}(\mathbf{t}) = \prod_{k = 1}^{n} F_{\xi_k}(t_k).
		\]
		А это означает, что \(\xi_{1}, \dots, \xi_{n}\) независимы в совокупности.
	\end{itemize}
\end{proof}

\subsection{Центральная предельная теорема и примеры её применения}
Наконец-то мы достигли <<жемчужины>> нашего курса~--- центральной предельной теоремы, на которой, можно сказать, держится математическая статистика. Но на самом деле нет. Перед этим сформулируем теорему, необходимую для её доказательства.
\begin{theorem}[непрерывности]
	Пусть есть \(\{\xi_{n} \mid n \in \N\}\), \(\xi\)~--- случайные величины и \(\phi_{n}(t) = \phi_{\xi_n}(t)\).
	\begin{enumerate}
		\item Пусть \(\xi_{n} \dto \xi\). Тогда \(\phi_{n}(t) \to \phi_{\xi}(t)\) для любого \(t \in \R\).
		\item Пусть существует непрерывная в нуле функция \(\phi(t)\) такая, что
		\[
			\forall t \in \R \lim\limits_{n \to \infty} \phi_{n}(t) = \phi(t).
		\]
		Тогда \(\phi_{\xi}(t) = \phi(t)\) и \(\xi_{n} \dto \xi\).
	\end{enumerate}
\end{theorem}
\begin{proof}
	Без доказательства.\footnote{Мне это уже надоело, ей богу. Самое вкусное идёт без доказательства.}
\end{proof}

Впрочем, делать тут особо нечего: ЦПТ является простым следствием этой теоремы!
\begin{theorem}[центральная предельная]
	Пусть \(\{\xi_{n} \mid n \in \N\}\)~--- последовательность независимых и одинаково распределённых случайных величин, про которую известно, что \(\E{\xi_1} < \infty\) и \(0 < \D{\xi_{1}} < +\infty\). Далее, введём обозначения: \(S_n = \xi_{1} + \dots + \xi_{n}\), \(a = \E{\xi_1}\) и \(\sigma^2 = \D{\xi_{1}}\). Тогда
	\[
		\frac{S_n - \E{S_n}}{\sqrt{\D{S_n}}} \dto \mathcal{N}(0, 1).
	\]
\end{theorem}
\begin{proof}
	Утверждение равносильно (по теореме непрерывности) тому, что характеристическая функция случайной величины
	\[
		\mu_{n} = \frac{S_n - \E{S_n}}{\sqrt{\D{S_n}}}
	\]
	стремится к \(e^{-t^2/2}\). Покажем это.
	
	Для этого немного преобразуем \(\mu_{n}\), пользуясь независимостью \(\xi_{i}\):
	\[
		\mu_{n} = \frac{\sum_{k = 1}^{n} (\xi_{k} - \E{\xi_{k}})}{\sqrt{\sum_{k = 1}^{n} \D{\xi_{k}}}} = \sum_{k = 1}^{n} \frac{\xi_{k} - a}{\sqrt{n}\sigma} = \left[\eta_{k} = \frac{\xi_{k} - a}{\sigma}\right] = \sum_{k = 1}^{n} \frac{\eta_{k}}{\sqrt{n}}.
	\]
	Заметим, что \(\E{\eta_{k}} = 0\) и \(\D{\eta_{k}} = 1\). Отсюда получаем, что \(\E{\eta_{k}^2} = 1\) и
	\[
		\phi_{\eta_k}(t) = 1 - \frac{t^2}{2} + o(t^2).
	\]
	Теперь посмотрим на характеристическую функцию \(\mu_{n}\) и воспользуемся тем, что \(\eta_{k}\) независимы в совокупности, как функции от независимых случайных величин:
	\[
		\phi_{\mu_n}(t) = \E{e^{it\sum_{k = 1}^{n} \frac{\eta_{k}}{\sqrt{n}}}} = \prod_{k = 1}^{n} \phi_{\eta_k}\left(\frac{t}{\sqrt{n}}\right) = \left(1 - \frac{t^2}{2n} + o\left(\frac{t^2}{n^2}\right)\right)^n
	\]
	Но это, как известно, стремится к \(e^{-t^2/2}\) при \(n \to \infty\). Тогда \(\mu_{n} \dto \mathcal{N}(0, 1)\), что и требовалось доказать.
\end{proof}
\begin{remark}
	Утверждение ЦПТ равносильно следующему:
	\[
		\sqrt{n}\left(\frac{S_n}{n} - \E{\xi_{1}}\right) \dto \mathcal{N}(0, \D{\xi_1}).
	\]
\end{remark}
\begin{consequence}
	С помощью ЦПТ можно оценить скорость сходимости в законе больших чисел. Неформально,
	\[
		\frac{S_n}{n} - \E{\xi_{1}} = O\left(\frac{1}{\sqrt{n}}\right).
	\]
\end{consequence}
Теперь рассмотрим пример применения ЦПТ, более приближенный к реальности.
\begin{example}
	Допустим, что во время эксперимента мы получили \(10^{4}\) чисел, причём каждое из них измерено с точностью \(10^{-6}\). В каких пределах лежит суммарная ошибка, если все числа получены независимо друг от друга?
\end{example}
\begin{proof}[Решение]
	Пусть \(\xi_{i}\)~--- погрешность в вычислении \(i\)-го числа. Будем считать, что \(\xi_{i} \sim U(-10^{-6}, 10^{-6})\). Тогда \(\E{\xi_{i}} = 0\) и \(\sigma^2 = \D{\xi_{i}} = \frac{10^{-12}}{3}\). Далее, введём обозначение \(S_n = \xi_{1} + \dots + \xi_{n}\)~--- суммарная ошибка первых \(n\) измерений. Тогда по центральной предельной теореме для достаточно больших \(n\)
	\[
		\Pr{\frac{|S_n|}{\sigma\sqrt{n}} \leq x} \approx \Phi(x) - \Phi(-x).
	\]
	Теперь возьмём \(x\) такое, чтобы \(\Phi(x) - \Phi(-x) \geq 0.99\). Можно проверить, что \(x \approx 2.58\) вполне подходит. Тогда с вероятностью \(0.99\) выполнено, что
	\[
		|S_n| \leq x\sigma\sqrt{n} = 258 \cdot \frac{10^{-6}}{\sqrt{3}} \approx 1.5 \cdot 10^{-4}.\qedhere
	\]
\end{proof}

Хорошо, ЦПТ дала нам скорость сходимости для ЗБЧ. А насколько быстро сходится сама ЦПТ? Ответ на этот вопрос даёт следующая 
\begin{theorem}[Берри, Эссеен]
	Пусть \(\{\xi_{n} \mid n \in \N\}\)~--- последовательность независимых и одинаково распределённых случайных величин. Далее, пусть выполнены следующие ограничения: \(\E{|\xi_1|^3} < +\infty\) и \(0 < \D{\xi_1} < +\infty\). Введём следующие обозначения:
	\begin{gather*}
		S_n = \sum_{k = 1}^{n} \xi_{k} \\
		T_n = \frac{S_n - \E{S_n}}{\sqrt{\D{S_n}}}
	\end{gather*}
	Тогда
	\[
		\sup_{x \in \R} \left|F_{T_n}(x) - \Phi(x)\right| \leq 
		\frac{C\E{|\xi_1 - \E{\xi_1}|^3}}{\D{\xi_{1}}^{3/2}\sqrt{n}},
	\]
	где \(C\)~--- это некоторая постоянная, не зависящая от \(\xi_{n}\).
\end{theorem}
\begin{proof}
	Без доказательства.
\end{proof}
Что же мзвестно про \(C\) в теореме Берри-Эссеена? Вообще, первоначально было доказано, что \(C \leq 100\) и \(C \geq \frac{1}{\sqrt{2\pi}}\), причём оценка снизу неулучшаема. Верхнюю же оценку постепенно снижали. В 2013 году доказали, что \(C \leq 0.48\).

Как показывает следующий пример, центральную предельную теорему можно использовать для оценки параметров распределения случайной величины.
\begin{example}
	Пусть нам известно, что \(\xi_{1}, \dots, \xi_{n} \sim \mathcal{N}(a, \sigma^2)\) и \(n\) достаточно большое, но не известны \(a\) и \(\sigma\). Мы провели \(n\) независимых наблюдений и получили значения \(\xi_{1}, \dots, \xi_{n}\). Как оценить \(a\) и \(\sigma\)?
\end{example}
\begin{proof}[Решение]
	Для начала оценим \(a\). Пусть \(\overline{\xi}_n = \frac{\xi_{1} + \dots + \xi_{n}}{n}\). Вообще говоря, хотелось бы сразу сказать, что по ЗБЧ
	\[
		\overline{\xi}_n \approx a.
	\]
	Но это верно с какой-то неизвестной погрешностю~--- у нас же конечное число измерений. Придётся воспользоваться ЦПТ для оценки погрешности:
	\[
		\sqrt{n}\left(\frac{\overline{\xi}_n - a}{\sigma}\right) \dto N(0, 1) \implies \Pr{\sqrt{n}\left|\frac{\overline{\xi}_n - a}{\sigma}\right| \leq y} \approx \Phi(y) - \Phi(-y).
	\]
	Возьмём \(y \approx 2.58\). Тогда с вероятностью \(0.99\) верно, что
	\[
		\overline{\xi}_n - \frac{\sigma y}{\sqrt{n}} \leq a \leq \overline{\xi}_n + \frac{\sigma y}{\sqrt{n}}
	\]
	Проблема~--- нам всё ещё не известно значение \(\sigma\). Как его найти? Это мы уже обсудим в следующий раз.
\end{proof}