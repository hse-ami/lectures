\section{Лекция от 14.02.2017}

\subsection{Закон повторного логарифма}

В этой лекции докажем этот закон и поймём, что обычной техникой оценивания
через ЦПТ и некоторые другие теоремы вообще не работают.

Вспомним, что мы хотим глобально. Введем 2 события для произвольного $\epsilon > 0$:

\[
  A_n = \{S_n \geq (1 + \epsilon)\sqrt{2n\ln\ln n}\},
  B_n = \{S_n \geq (1 - \epsilon)\sqrt{2n\ln\ln n}\}
\]

Чтобы доказать утверждение теоремы, надо показать, что

\[
  \Pr{\{\text{$A_n$ б.ч.}\}} = 0;
  \Pr{\{\text{$B_n$ б.ч.}\}} = 1
\]

\subsection{Следствие из ЦПТ и теоремы Берри-Эссеена}

Если вспомнить ЦПТ и теорему Берри-Эссеена, тогда (учитывая, что третий момент конечен и
$\E{\xi_1} = 0, \D{\xi_1} = 1$) получаем, что

\[
  \sup\limits_{x \in \R} 
  \left|\Pr{\frac{S_n - n\E{\xi_1}}{\sqrt{n\D{\xi_1}}} < x} - \Phi_{\mathcal{N}(0, 1)}(x)\right|
  \leq \frac12 \frac{\E{|\xi_1 - \E{\xi_1}|^3}}{\sqrt{n}\D{\xi_1}^{3/2}} =
  \mathcal{O}\left(\frac{1}{\sqrt{n}}\right)
\]

Докажем одну лемму, которая нам в будущем пригодится, а именно она относительно
неплохо оценивает функцию распределения нормального стандартного распределения:

\begin{lemma}
  При всех достаточно больших $x$ (скажем, $x > 1$) выполняется

  \[
    \frac{1}{\sqrt{2\pi}}e^{\frac{-(x + 1)^2}{2}} \leq 1 - \Phi(x) = 
    \int\limits_{x}^{+\infty} \frac{1}{\sqrt{2\pi}}e^{-\frac{y^2}{2}}\,dy
    \leq \frac{1}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}
  \]
\end{lemma}

\begin{proof}
  Оценить снизу совсем просто. Действительно, интеграл убывает экспоненциально,
  поэтому основная его часть концентрируется около $x$:

  \[
    \int\limits_{x}^{+\infty} \frac{1}{\sqrt{2\pi}}e^{-\frac{y^2}{2}}\,dy
    \geq \int\limits_{x}^{x + 1} \frac{1}{\sqrt{2\pi}}e^{-\frac{y^2}{2}}\,dy
    \geq \frac{1}{\sqrt{2\pi}}e^{\frac{-(x + 1)^2}{2}}
  \]

  Где последнее неравенство следует из того, что функция под интегралом не меньше,
  чем написанная в выражении. По-другому можно воспользоваться теоремой о среднем
  и показать оценку уже напрямую.

  Оценить сверху немного сложнее. Заметим, что при $x > 1$ будет выполнено следующее
  неравенство для всех $y > x$:

  \[
    y - \frac{y^2}{2} < x - \frac{x^2}{2}
  \]

  В этом легко убедиться, так как у этого квадратного сравнения будут корни 
  $y_1 = x, y_2 = 2 - x$, но при $x > 1$ будет выполнено $y_1 > y_2$, а мы знаем,
  что $y > x$, поэтому действительно парабола будет принимать положительное значение.

  А теперь давайте оценивать интеграл с помощью сравнений функций и обычного
  интегрирования:

  \[
     \int\limits_{x}^{+\infty} \frac{1}{\sqrt{2\pi}}e^{y - \frac{y^2}{2} - y}\,dy
     \leq  e^{x - \frac{x^2}{2}}\int\limits_{x}^{+\infty} \frac{1}{\sqrt{2\pi}}e^{-y}\,dy
     = \frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}
  \]
\end{proof}

Из теоремы Берри-Эссеена можно даже написать равенство (запихать остаток в О-большое)
для $\Pr{S_n \geq t}$ при подстановке $x = \frac{t}{\sqrt{n}}$:

\[
  \Pr{S_n \geq t} = 1 - \Phi\left(\frac{t}{\sqrt{n}}\right) + \mathcal{O}\left(\frac{1}{\sqrt{n}}\right)
\]

Воспользуемся доказанным неравенством, получим, что:

\[
  \Pr{S_n \geq t} = e^{-\frac{t^2}{2n}(1 + o(1))} + \mathcal{O}\left(\frac{1}{\sqrt{n}}\right)
\]

Мы знаем, что при $t = \sqrt{2n\ln\ln n}$ следует, что $x = \frac{t}{\sqrt{n}} > 1$,
поэтому неравенством мы корректно воспользовались, а в $o(1)$ запихали всё ненужное.

Теперь подставим наше $t$

\[
  \Pr{S_n \geq t} \sim \frac{1}{(\ln n)^{1 + o(1)}} + \mathcal{O}\left(\frac{1}{\sqrt{n}}\right)
\]

Но если мы хотим воспользоваться леммой Бореля-Кантелли, нам надо или чтобы
события были независимы, или чтобы ряд сходился. Но у нас тут ряд логарифмов! А события
очевидно все зависимы.
Ряд расходится, какую там степень бы не написать. Да даже больше --- остаток расходится!
Плохо, нужна другая техника, чтобы доказать ЗПЛ.

\subsection{Доказательство ЗПЛ}

Следующая лемма показывает, насколько максимально мы можем уйти. Точнее связь
между всеми предыдущими значениями блуждания и последнего.

\begin{theorem}
  Пусть $\{\xi_n, n \in \N\}$ независимые одинаково распределенные случайные
  величины с симметричным распределением (то есть $\xi_k \eqdist -\xi_k$), а
  $S_n = \xi_1 + \ldots + \xi_n$. Тогда $\forall a > 0$:

  \[
    \Pr{\max\limits_{k \leq n} S_k \geq a} \leq 2\Pr{S_n \leq a}
  \]
\end{theorem}

\begin{proof}
  Давайте введем все нужные события:

  \[
    A = \{\max\limits_{k \leq n} S_k \geq a\}
  \]

  Понятное дело, что без $A$ не обойтись, если мы хотим доказать теорему. Аналогично
  не обойтись без $B$:

  \[
    B = \{S_n \geq a\}
  \]

  А теперь давайте попытаемся представить $A$ в виде дизъюнктного объединения
  каких-то событий. Для этого часто в теории вероятностей вводят события первых
  моментов:

  \[
    A_k = \{S_1 < a, \ldots, S_{k - 1} < a, S_k \geq a\}
  \]

  Действительно, $A = \bigsqcup\limits_{k = 1}^n A_k$, так как
  $A_k$ не пересекаются и образуют всё $A$.

  Также давайте поймём следующее включение:
  \[
    A_k \cap \{S_n - S_k \geq 0\} \subseteq A_k \cap B
  \]

  Действительно, если уж $S_k \geq a$, то если $S_n \geq S_k$, тогда и
  $S_n \geq a$, то есть все события слева включены в правое. Но чем же хорошо
  это включение? Да тем, что слева независимые события, так как
  $A_k$ никак не зависит от $\xi_{k + 1}, \ldots, \xi_n$. Это нам пригодится.

  Ура, у нас уже
  есть какие-то включения, давайте уже что-то оценивать. Будем аккуратно
  расписывать наше неравенства:
  \[
    \Pr{B} \geq \sum\limits_{k = 1}^n \Pr{B \cap A_k}
  \]

  Действительно, мы просто пересекаем событие $B$ с непересекающимися между
  собой $A_k$. По включению выше мы получаем, что 

  \[
    \sum\limits_{k = 1}^n \Pr{B \cap A_k} \geq \sum\limits_{k = 1}^n \Pr{A_k \cap \{S_n - S_k \geq 0\}}
  \]

  Из-за независимости событий получаем равенство:

  \[
    \sum\limits_{k = 1}^n \Pr{A_k \cap \{S_n - S_k \geq 0\}} = 
    \sum\limits_{k = 1}^n \Pr{A_k} \Pr{\{S_n - S_k \geq 0\}}
  \]

  Но вторая вероятность не меньше $\frac12$ из-за симметричности распределения
  и тем, что ещё может достигаться равенство. Поэтому последнее неравенство:

  \[
    \sum\limits_{k = 1}^n \Pr{A_k} \Pr{\{S_n - S_k \geq 0\}} \geq
    \frac12\sum\limits_{k = 1}^n \Pr{A_k} = \frac12 \Pr{A}
  \]

  Где последнее равенство из-за дизъюнктности объедения $A_k$.
\end{proof}

Сейчас мы имеем весь арсенал, чтобы доказать ЗПЛ.

\begin{proof}
  Сначала докажем, что $\Pr{\{\text{$A_n$ б.ч.}\}} = 0$. Для этого введем некоторые
  обозначения при фиксированном $\epsilon > 0$:

  \[
    \begin{cases}
      \epsilon \in (0, 1]\\
      \lambda = 1 + \epsilon\\
      n_k = \lambda^k\\
      k_0: k \geq k_0, \text{ что } \ln\ln k > 0\\
      C_k = \bigcup\limits_{\substack{n > n_{k - 1},\\n \leq n_k}} A_k
    \end{cases}
  \]

  Несложно понять, что $\{A_n\text{ б.ч.}\}$ совпадает с $\{C_k\text{ б.ч.}\}$.

  Будем считать $\Pr{C_k}$:

  \[
    \Pr{C_k} \leq \Pr{\max\limits_{n \leq n_k} S_n \geq \lambda\sqrt{2n_{k - 1}\ln\ln n_{k - 1}}}
  \]

  Действительно, мы смотрим, что хотя бы один до $n_k$ (знак $\leq$ из-за того,
  что есть ещё целые числа от $1,\ldots,n_{k - 1}$) больше нужного значения.
  По теореме 9 мы получаем, что

  \[
    \Pr{C_k} \leq 2\Pr{S_{\lfloor n_k\rfloor} \geq \lambda\sqrt{2n_{k - 1}\ln\ln n_{k - 1}}}
  \]

  А теперь вспомним оценку нашего интеграла (да, тут она уже сработает):

  \[
    2\Pr{S_{\lfloor n_k\rfloor} \geq \lambda\sqrt{2n_{k - 1}\ln\ln n_{k - 1}}}
    \leq 2\exp\left(\frac{-\lambda^2 2 n_{k - 1}\ln\ln n_{k - 1}}{2\lfloor n_k\rfloor}(1 + o(1))\right)
    + \mathcal{O}\left(\frac{1}{\sqrt{n_k}}\right)
  \]

  Также заметим, что $\frac{n_{k - 1}}{\lfloor n_k \rfloor} = \frac{1}{\lambda}(1 + o(1))$,
  поэтому это можно внести под то о-малое. А $\ln\ln n_{k - 1} = \ln k + o(1)$.

  Поэтому это всё эквивалентно:

  \[
    = 2\exp\left((-\lambda \ln k)(1 + o(1))\right)
    + \mathcal{O}\left(\frac{1}{\sqrt{\lambda}^k}\right) = 
    2 k^{-(1 + \epsilon)(1 + o(1))} 
    + \mathcal{O}\left(\frac{1}{\sqrt{\lambda}^k}\right)
  \]

  Что несомненно сходится. По лемме Бореля-Кантелли получаем, что как раз
  вероятность $\Pr{C_k} \leqslant  2 k^{-(1 + \epsilon)(1 + o(1))} 
  + \mathcal{O}\left(\frac{1}{\sqrt{\lambda}^k}\right)$, поэтому ряд
  из $\Pr{C_k}$ будет сходиться, поэтому и  $\Pr{\{C_k\text{ б.ч.}\}} = 0$,
  и $\Pr{\{A_n\text{ б.ч.}\}} = 0$.

  Для второго подпункта введём свои обозначения при фиксированном $\epsilon > 0$:

  \[
    \begin{cases}
      n_k = N^k, \text{ $N \in \N$ мы определим чуть позднее }\\
      \lambda = 1 - \epsilon\\
      \epsilon \in (0, 1)
    \end{cases}
  \]

  Рассмотрим последовательность $\{-S_n, n \in \N\}$. По пункту один мы выяснили,
  что $D_k = \{-S_{n_k} \leq 2\sqrt{2n_k\ln\ln n_k}\}$ происходит с вероятностью
  один конечное число раз.

  Поэтому давайте выпишем событие $B_{n_k}$. Если мы докажем для какой-то 
  подпоследовательности, что вероятность бесконечного числа равна единице,
  то тогда понятно, что и для всей последовательности оно будет с вероятностью
  один.

  \begin{multline}
    Q_k = \{S_{n_k} \geq \lambda \sqrt{2n_k \ln\ln n_k}\} = 
    \{S_{n_k} - S_{n_{k - 1}} \geq \lambda \sqrt{2n_k \ln\ln n_k} - S_{n_{k - 1}}\} 
    \supseteq\\\supseteq \{S_{n_k} - S_{n_{k - 1}} \geq
    \lambda \sqrt{2n_k \ln\ln n_k} + 2\sqrt{2n_{k - 1}\ln\ln n_{k - 1}}\}
  \end{multline}

  Где последнее включение следует как раз из-за того, что с вероятностью один
  мы с какого-то момента имеем корректное неравенство. И если мы докажем для
  последнего события, что оно бесконечное число раз выполняется с вероятностью
  один, то автоматически докажем теорему.

  Заметим, что 
  
  \[
    \lambda\sqrt{2n_k \ln\ln n_k} + 2\sqrt{2n_{k - 1}\ln\ln n_{k - 1}} \leq
    \lambda\sqrt{2n_k \ln\ln n_k}\left(1 + 2\sqrt{\frac{1}{N\lambda^2}}\right) =
    \lambda'\sqrt{2n_k \ln\ln n_k}
  \]
  Где $\lambda' \in (\lambda, 1)$. Такое $\lambda'$ можно подобрать, если взять
  $N$ очень большое. Поэтому усилим оценку и будем доказывать, что будет вероятность
  один у б.ч. у события

  \[
    \{S_{n_k} - S_{n_{k - 1}} \geq
    \lambda'\sqrt{2n_k \ln\ln n_k}\}
  \]

  Заметим, что все $Q_k$ независимы, так как не пересекаются по $\xi_i$, значит
  уже есть вера в то, что можно воспользоваться леммой Бореля-Кантелли.

  Обозначим за $Y_k = S_{n_k} - S_{n_{k - 1}}$. Тогда

  \[
    \Pr{Q_k} \geq \Pr{Y_k \geq \lambda'\sqrt{2n_k\ln\ln n_k}} = 
    \exp\left(\frac{-\lambda'^22n_k\ln\ln n_k}{2(n_k - n_{k - 1})}(1 + o(1))\right) +
    \mathcal{O}\left(\frac{1}{\sqrt{N}^k}\right) =
  \]

  А теперь давайте всё подряд оценивать. $\ln\ln n_k = \ln k + \ln\ln N = \ln k + o(1)$
  при достаточно больших $k$ ($N$ зависит только от $\epsilon$).

  \[
    = \exp\left(\frac{-\lambda'^2\ln k}{1 - \frac{1}{N}}(1 + o(1))\right) + 
    \mathcal{O}\left(\frac{1}{\sqrt{N}^k}\right) =
  \]

  А теперь давайте поймём, что $\frac{\lambda'^2}{1 - \frac{1}{N}} < 1$ можно
  сделать. Действительно, при $N \to +\infty$ следует, что $\lambda' \downarrow \lambda$,
  а значит при увеличении $N$ выражение стремится к числу, меньшему единице, значит
  с какого-то момента будет меньше единицы. Отлично! Пусть  $\frac{\lambda'^2}{1 - \frac{1}{N}} =
  \delta < 1$. Тогда получаем:

  \[
    = k^{-(1 - \delta)(1 + o(1))} +\mathcal{O}\left(\frac{1}{\sqrt{N}^k}\right)
  \]

  Что расходится, как сумма сходящегося и рассходящегося рядов. События независимы,
  поэтому по лемме Бореля-Кантелли вероятность б.ч. равна единице.
\end{proof}

Закон повторного логарифма, конечно, работает и при других ограничениях на $\xi_i$.
Но нам хватило, как мы считаем, и для случайного блуждания. Оставим общий ЗПЛ
без доказательства.

\begin{theorem}
  Пусть $\{\xi_n, n \in \N\}$ независимые одинаково распределенные случайные
  величины со средним ноль и положительной дисперсией $\sigma^2$. Тогда

  \[
    \Pr{ \varlimsup\limits_{n \to +\infty} \frac{S_n}{\sqrt{2n\sigma^2\ln\ln n}} = 1} = 1 
  \]
\end{theorem}

На этом со случайным блужданием мы заканчиваем.

\subsection{Ветвящиеся случайные процессы}

\subsection{Физическая модель}

Физическая модель у этих процессов достаточно естественная. Сначала есть
один человек. С какой-то вероятностью он порождает потомков. Потом каждый потомок
независимо от остальных
с тем же распределением порождает ещё несколько. Все предыдущие поколения умирают.
Так повторяется либо пока не останется ни одного потомка, либо бесконечно.
Можно считать, что так мы смотрим, вымрет ли род когда-нибудь, насколько долго
он будет жить и насколько он будет широким.

\subsection{Математическая модель}

\begin{definition}
  Пусть $\xi$ --- случайная величина со значениями в $\Z_+$ 
  (называемый \textit{законом размножения}). Пусть $\xi_{k}^{(n)}$ одинаково
  распределенные случайные величины с распределением, как у $\xi$.

  Тогда введём $X_n$ --- число частиц в $n$-ом поколении. Тогда $X_0 = 1$, а
  $X_n = \sum\limits_{k = 1}^{X_{n - 1}}\xi_{k}^{(n)}$. Фактически, $\xi_{k}^{(n)}$
  отвечает за число потомков $k$-ой частицы в $n - 1$-ом поколении.

  Такой процесс называется \textit{процессом Гамильтона-Ватсона с законом
  размножения частиц $\xi$}. 
\end{definition}

Ясно, что нас интересуют изначально вопрос о вырождении, то есть 
$\Pr{\exists n : X_n = 0}$. Анонсируем сразу ответ, на следующей лекции докажем

\[
  \text{Если $\E{\xi} \leq 1$, тогда $\Pr{\exists n : X_n = 0} = 1$, кроме случая
  $\xi = 1$}.
\]

\[
  \text{Если $\E{\xi} > 1$, тогда $\Pr{\exists n : X_n = 0} < 1$}.
\]
