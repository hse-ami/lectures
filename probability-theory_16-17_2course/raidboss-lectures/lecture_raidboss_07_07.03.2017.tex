\section{Лекция от 07.03.2017}

Первые 25 минут лекции были посвящены холивару по поводу домашнего задания по
случайным блужданием. В частности по девятой задаче и корректности
перехода к пределу в функциональных рядах.

\subsection{Пороговые функции}


\begin{lemma}[О монотонности вероятности]
  Пусть $Q$ возрастающее свойство на $n$ вершинах, тогда если $0 \leq p_1
  < p_2 \leq 1$ и $0 \leq m_1 < m_2 \leq \binom{n}{2}$, то

  \[
    \Pr{G(n, p_1) \in Q} \leq \Pr{G(n, p_2) \in Q}, \Pr{G(n, m_1) \in Q} \leq
    \Pr{G(n, m_2) \in Q}
  \]
\end{lemma}

\begin{proof}
  Легко упражнение заключается в том, что если $G(n, p')$ и $G(n, p'')$ независимые
  два случайных графа, то $G(n, p') \cup G(n, p'') \eqdist
  G(n, p' + p'' - p'p'')$. 

  Действительно, посмотрим на вероятность получения одного графа с количеством
  ребер $|E(G)|$ с вероятностью $p' + p'' - p'p''$. По определению вероятность равна
  $(p' + p'' - p'p'')^{|E(G)|}(1 - p' - p'' + p'p'')^{\binom{n}{2} - |E(G)|}$. А теперь
  посмотрим на левую часть. Оба подграфа должны быть подграфом фиксированного $G$.
  Вероятность того, что $G(n, p')$ является подграфом $G$ равна
  \[
    \sum\limits_{m = 0}^{|E(G)|} \binom{|E(G)|}{m}p'^m(1 - p')^{\binom{n}{2} - m}
  \]

  А теперь надо, чтобы второй процесс выбрал все недостающие ребра (это происходит
  с вероятностью $p''^{|E(G)| - m}$), а также можно выбирать выбранные уже первым процессом
  ребра. Вероятность такого равна $(1 - p'')^{\binom{n}{2} - |E(G)|}$, так как запрещено
  брать оставшиеся ребра. В итоге вероятность объединения равна:

  \[
    \sum\limits_{m = 0}^{|E(G)|} \binom{|E(G)|}{m}p'^mp''^{|E(G)| - m}(1 -
    p')^{\binom{n}{2} - m}(1 - p'')^{\binom{n}{2} - |E(G)|}
  \]

  Вынесем $(1 - p'')^{\binom{n}{2} - |E(G)|} (1 - p')^{\binom{n}{2} - |E(G)|} =
  (1 - p' - p'' + p'p'')^{\binom{n}{2} - |E(G)|}$, что даёт один множитель. А теперь
  давайте посчитаем оставшийся множитель:

  \[
    \sum\limits_{m = 0}^{|E(G)|} \binom{|E(G)|}{m}p'^mp''^{|E(G)| - m}(1 -
    p')^{|E(G)| - m} = (p' + p''(1 - p'))^{|E(G)|} = (p' + p'' - p'p'')^{|E(G)|}.
  \]

  Отлично, с упражнением разобрались, давайте теперь доказывать теорему.

  Введем $p' = \frac{p_2 - p_1}{1 - p_1}$ (тут как раз потребовалось, что
  $1 - p_1 > 0$) и возьмём $G(n, p')$ независимый с
  $G(n, p_1)$, тогда (из-за того, что свойство возрастающее):

  \[
    \Pr{G(n, p_1) \in Q} \leq \Pr{G(n, p_1) \cup G(n, p') \in Q} = \Pr{G(n, p' + p_1 - p'p_1) \in Q} =
    \Pr{G(n, p_2) \in Q}.
  \]

  С равномерной моделью всё ещё проще. Вспомним, что $\tilde{G}(n, m_1) \eqdist
  G(n, m_1)$, откуда

  \[
    \Pr{G(n, m_1) \in Q} = \Pr{\tilde{G}(n, m_1) \in Q} \leq \Pr{\tilde{G}(n, m_2) \in Q}
    = \Pr{G(n, m_2) \in Q}.
  \]

  Основное неравенство появляется из-за того, что в случайном процессе мы добавляем
  ребра и свойство возрастающее.
\end{proof}

\begin{definition}
  Пусть $Q(n)$ --- возрастающее свойство графов, тогда функция $\hat{p}(n)$ называется
  пороговой для $Q(n)$, если выполнено следующее

  \[
    \lim\limits_{n \to +\infty} \Pr{G(n, p(n)) \in Q} =
    \begin{cases}
      0, p(n) = o(\hat{p}(n))\\
      1, \hat{p}(n) = o(p(n))
    \end{cases}
  \]
\end{definition}

Неформально это свойство означает, что пороговая функция это эдакий разделитель
для свойства, когда оно никогда не выполняется и когда всегда. При 
$p(n) = \Theta\left(\hat{p}(n)\right)$ часто возникают интересные результаты. Давайте приведем примеры:


\begin{itemize}
  \item \textbf{Связность}

  Пороговая вероятность в данном случае равна $\hat{p}(n) = \frac{\ln n}{n}$.
  На пороге верно следующее утверждение, которое мы докажем позднее: если 
  $p(n) = \frac{\ln n + \lambda + o(1)}{n}$, тогда $\Pr{G \text{ --- связен}} \to
  e^{-e^{-\lambda}}$ (да, этот результат производит некоторое впечатление катарсиса).
  Это распределение называется распределением Гумбеля.

  \item \textbf{Наличие треугольников}

  Пороговая вероятность $\hat{p}(n) = \frac{1}{n}$.

  \item \textbf{$\min \mathrm{deg} \geq k$}

  Пороговая вероятность в данном случае совершенно не зависит от $k$ (что понятно,
  так как при достаточно больших $n$ уже становится маловероятно, что $k$ как-то
  сильно играет роль) и равна $\frac{\ln n}{n}$. Также тут известен более точный
  результат: если $p = \frac{\ln n + (k - 1)\ln\ln n + w(n)}{n}$ и $w(n)$ растет,
  тогда вероятность стремится к единице, если убывает, тогда стремится к нулю.
\end{itemize}

Наша основная задача до конца лекции --- доказать, что пороговая функция
всегда существует для всех возрастающих свойств для биномиальной модели (для
равномерной надо чуть больше париться, нам оно не потребуется тем более).

\begin{definition}
  Если $Q$ возрастающее свойство, тогда введем функцию
  \[
    f(p) = \Pr{G(n, p) \in Q}
  \]
\end{definition}

\begin{lemma}[Лемма о функции $f$]
  Если $Q$ нетривиальное свойство, тогда $f(p)$ непрерывно строго возрастающая функция.
\end{lemma}

\begin{proof}
  То, что $f(p)$ возрастающая напрямую следует из леммы о монотонности вероятности
  в возрастающем свойстве. Так же отметим, что раз свойство нетривиальное, то
  $f(0) = 0, f(1) = 1$. Выпишем $f(p)$ в явном виде:

  \[
    f(p) = \sum\limits_{G} p^{|E(G)|}(1 - p)^{\binom{n}{2}-|E(G)|}
  \]

  Это многочлен, притом он не константа из-за того, что на концах отрезка принимает
  различные значения. И если у нас есть промежуток постоянства со значением 
  $C$, то у $f(p) - C$ бесконечно много корней, что не может быть у неконстантного
  многочлена. Значит эта функция непрерывна и строго возрастает.
\end{proof}

\begin{definition}
  Для любого $a \in (0, 1)$ введем $p(a, n) = f^{-1}(a)$ --- вероятность $p(a, n)$,
  что $\Pr{G(n, p(a, n)) \in Q} = a$. Такое значение всегда найдётся из-за 
  строгой монотонности и непрерывности.
\end{definition}

\subsection{Существование пороговой вероятности}

\begin{theorem}[Критерий пороговости]
  Функция $\hat{p}(n)$ является пороговой для возрастающего нетривиального свойства
  $Q \iff \forall a \in (0, 1) \implies p(a, n) = \Theta(\hat{p}(n))$. 
\end{theorem}

\begin{proof}
  $\Rightarrow$ Пусть $\exists a \in (0, 1)$, что $p(a, n) \neq \Theta(\hat{p}(n))$,
  откуда существует подпоследовательность $\{n_k\}_{k = 0}^{+\infty}$ такая,
  что 
  \[
    \left[
      \begin{aligned}
        p(a, n_k) = o(\hat{p}(n_k))\\
        \hat{p}(n_k) = o(p(a, n_k))
      \end{aligned}
    \right.
  \]

  В любом случае получаем, что или $a = 0$ или $a = 1$, так как $\Pr{G(n, p(a, 
  n_k)) \in Q} = a$, а те условия дают именно определение пороговой функции. Но
  мы так же знаем, что $a \in (0, 1)$, поэтому получаем противоречие.

  $\Leftarrow$ Пусть $\hat{p}$ удовлетворяет данному свойству. Тогда рассмотрим
  случай, когда $p = o(\hat{p})$, тогда $p = o(p(a, n)) \forall a \in (0, 1)$,
  тогда $\Pr{G(n, p) \in Q} \leq \Pr{G(n, p(a, n)) \in Q}$ для всех достаточно
  больших (можно считать, что для всех) $n$. Откуда

  \[
    \varlimsup\limits_{n \to +\infty} \Pr{G(n, p) \in Q} \leqslant a, \ \forall a \in (0, 1)
  \]

  Откуда и сам предел равен нулю. Другой случай совершенно аналогичен с точностью
  до замены знаков и нижнего предела.
\end{proof}

Теперь мы наконец-то дошли до самого существования. Также заметим, что для
тривиальных свойств пороговые функции не определены (мы не знаем, что такое
$o(0)$), но с этими свойствами и так всё ясно. Поэтому будем доказывать теорему
для нетривиальных свойств.

\begin{theorem}[О пороговой вероятности]
  Любое нетривиальное монотонное свойство имеет пороговую вероятность.
\end{theorem}

\begin{proof}
  Будем доказывать только для возрастающих свойств. Для убывающих аналогично.

  Используя предыдущую лемму, покажем, что $\forall a \in (0, 1) \implies
  p(a, n) = \Theta\left(p\left(\frac12, n\right)\right)$.

  Зафиксируем $\epsilon > 0$ и возьмём натуральное $m$ такое, что 
  $(1 - \epsilon)^m < \epsilon$. Рассмотрим случайные независимые графы 
  $G^{(1)}(n, p(\epsilon, n)), \ldots, G^{(m)}(n, p(\epsilon, n))$. Рассмотрим
  $\tilde{G} = G^{(1)} \cup \ldots \cup G^{(m)}$. Посмотрим на вероятность, что
  $\tilde{G}$ не обладает этим свойством. Это означает, что каждое из $G^{(i)}$
  этим свойством не обладал, поэтому из-за независимости событий получаем,
  что $\Pr{\tilde{G} \not\in Q} \leq (1 - \epsilon)^m < \epsilon$. Откуда получаем,
  что $\Pr{\tilde{G} \in Q} \geq 1 - \epsilon$.

  По индукции легко получить, что $\tilde{G} \eqdist G(n, p')$, где $p' = 1 - (1 - 
  p(\epsilon, n))^m$. Из неравенства Бернулли получим, что $p' \leq m p(\epsilon, n)$.

  Так как $\Pr{\tilde{G} \in Q} \geq 1 - \epsilon$, то $p' \geq p(1 - \epsilon, n)$
  из-за монотонности вероятности. Откуда получаем двойное неравенство:

  \[
    \forall \epsilon \in \left(0, \frac12\right) \implies \frac{1}{m}p(1 - \epsilon, n)
    \leq p(\epsilon, n) \leq p(1 - \epsilon, n)
  \]

  В итоге получаем цепочку неравенств для всех $\epsilon \in \left(0, \frac12\right)$:

  \[
    \frac1m p(1 - \epsilon, n) \leq p(\epsilon, n) \leq p\left(\frac12, n\right)
    \leq p(1 - \epsilon, n) \leq mp(\epsilon, n)
  \]

  Откуда видно, что $p(\epsilon, n) = \Theta\left(p\left(\frac12, n\right)\right)$
  и $p(1 - \epsilon, n) = \Theta\left(p\left(\frac12, n\right)\right)$, так как
  $m$ не зависит от $n$. Значит мы доказали для всех $\epsilon \in (0, 1)$ (так как
  $1 - \epsilon \in (1/2, 1)$).
\end{proof}
